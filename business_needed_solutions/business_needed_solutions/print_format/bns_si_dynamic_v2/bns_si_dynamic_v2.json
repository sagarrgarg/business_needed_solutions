{
 "absolute_value": 0,
 "align_labels_right": 0,
 "creation": "2025-04-23 16:48:38.390423",
 "css": ".print-format {\n    margin-top:35mm;\n    margin-left: 0;\n    margin-right: 0;\n    /*height: 100% !important;*/\n    /*margin-bottom:5mm;*/\n}\n\n.print-heading{\n    border-bottom:1px solid #000;\n    margin-bottom:-5mm;\n    color:#000;\n    font-weight:bold;\n}\n\nh6{\n    font-weight: bold;\n    margin-top:0px;\n    margin-bottom:0px;\n}\n\n.no-border td {\n  border: none;\n  padding: 2px 4px;\n}\n\n.invoice-copy {\n  display: block;\n  font-size: 0.45rem;\n  margin-top: 3px;\n  margin-bottom: 6px;\n}\n\n\n.einv-det .col-xs-8.text-right .row.data-field {\n  /*margin-bottom: 4mm;*/\n  vertical-align: middle !important;\n  margin-left:0;\n  margin-right:0;\n  margin-top: 4mm;\n  margin-bottom:4mm;\n}\n\n.qrcode {\n  width: 50mm;\n  /*display: block;*/\n}\n\n.party-details-table {\n    /*table-layout: fixed;*/\n    width: 100%;\n    margin-bottom:auto;\n    padding-bottom:0;\n}\n.party-details-table td {\n    vertical-align: top;\n    /*padding: 8px;*/\n}\n\n.item-det{\n    margin:0;\n}\ntable{\n    margin:0 !important;\n}\n\n.item-det td,.item-det th{\n    text-align:center;\n    font-size:0.8em;\n    padding:0.2em !important;\n    vertical-align: middle !important;\n}\n\n.item-det .even td{\n    background-color: #f1f1f1;\n\n}\n.item-det .odd td {\n    background-color: #ffffff;\n}\n\n.item-det .item-det-item-name{\n    text-align:justify;\n    font-size:1em;\n    padding-left: 1mm !important;\n}\n\n.final-tax-total-table {\n  page-break-inside: avoid;\n  /*position: -webkit-sticky;*/\n  position: fixed;\n  bottom:0;\n  width:100%;\n}\n\n.no-preview-available {\n    color: grey;\n    font-size: 14px;\n}\n\n.page-footer-1 {\n    content: counter(page);\n    border-top:2px solid black;\n    margin-top: -35mm !important;\n    margin-bottom: -5mm !important;\n}\n\n.ewaybill-page-layout {\n    font-size: 10px;\n    line-height: 1.2;\n    box-sizing: border-box;\n    transform-origin: top center;\n    width: 100%;\n    margin: 0 auto;\n}\n.print-format table td img.barcode,\n.print-format table td img.qr-code {\n    margin-top: 5px;\n    width: 95px !important;\n    image-rendering: -webkit-optimize-contrast;\n}\n\n.watermark {\n  position: fixed;\n  top: 150mm;             /* push to vertical middle */\n  left: 0;            /* push slightly left */\n  width: 100%;\n  text-align: center;\n  font-size: 90px;\n  color: #000000;\n  opacity: 0.04;        /* light watermark */\n  -webkit-transform: rotate(-45deg);\n  -ms-transform: rotate(-45deg);\n  transform: rotate(-45deg);\n  z-index: 1000;\n}",
 "custom_format": 1,
 "default_print_language": "en",
 "disabled": 0,
 "doc_type": "Sales Invoice",
 "docstatus": 0,
 "doctype": "Print Format",
 "font_size": 14,
 "html": "{%- from \"templates/print_formats/standard_macros.html\" import add_header, render_field, print_value -%}\n\n{% set e_invoice_log = None %}\n{% if doc.irn %}\n{% set e_invoice_log = frappe.db.get_value(\n        \"e-Invoice Log\", doc.irn, (\"invoice_data\", \"signed_qr_code\"), as_dict=True\n    ) %}\n{% set invoice_data = e_invoice_log and e_invoice_log.invoice_data and _dict(json.loads(e_invoice_log.invoice_data)) or None %}\n{% endif %}\n\n{% macro format_address(address) %}\n{% if address %}\n<p>\n    {{ address.address_line1 }}\n    {% if address.address_line2 %}\n    {{ address.address_line2 }}<br>\n    {% endif %}\n    {{ address.city }}, {{ address.state }}, {{ address.country }}: {{ address.pincode }}<br>\n</p>\n{% endif %}\n{% endmacro %}\n\n{% set bns_settings = frappe.get_doc(\"BNS Settings\") %}\n{% set base_currency = frappe.db.get_value(\"Company\", doc.company, \"default_currency\") %}\n\n{% set copy_map = {\n    \"1\": \"Original for Recipient\",\n    \"2\": \"Duplicate for Transporter\",\n    \"3\": \"Duplicate for Supplier\",\n    \"4\": \"Triplicate for Supplier\"\n} %}\n\n{% set invoice_copy_param = frappe.form_dict.get(\"invoice_copy\") or \"1\" %}\n{% set invoice_copy_text = copy_map.get(invoice_copy_param, \"Original for Recipient\") %}\n\n\n<!--<div class=\"watermark text-center\">MEVABITE</div>-->\n\n<!--<div class=\"page\">-->\n\n\n<div id=\"header-html\">\n    <div class=\"watermark\">{{ invoice_copy_text }}</div>\n    <div class=\"row print-heading\" style=\"line-height:1.1;padding:10px\">\n        <div class=\"col-xs-3 column-break\">\n            {% set company_logo = frappe.db.get_value(\"Company\", doc.company, \"logo_for_printing\") %}\n            {% if company_logo %}\n            <div>\n                <img height=\"100px\" width=\"150px\" src=\"{{ company_logo }}\">\n            </div>\n            {% endif %}\n        </div>\n        <div class=\"col-xs-6 column-break text-center\">\n            <h2><b>{{ doc.company }}</b></h2>\n            {% if frappe.db.get_value(\"Company\",doc.company,\"bns_previously_known_as\") %}\n                <div>Previously Known As: {{frappe.db.get_value(\"Company\",doc.company,\"bns_previously_known_as\")}}</div>\n            {% endif %}\n            <div style=\"font-size:0.85rem\">\n                {% set seller_address = frappe.db.get_value(\"Address\", doc.company_address, [\"address_line1\", \"address_line2\", \"city\", \"state\", \"pincode\", \"country\"], as_dict=True) %}\n                    {{ format_address(seller_address) }}\n                    {% if doc.company_gstin %}\n                    GST: {{ doc.company_gstin }}<br>\n                    {% endif %}\n                    <p>PAN: {{ frappe.db.get_value(\"Company\", doc.company, \"pan\") }}</p>\n                \n            </div>\n        </div>\n        <div class=\"col-xs-3 column-break text-right\">\n            <h2 style=\"margin:0;\"><b>\n                    {% if doc.status == \"Cancelled\" and doc.is_return %}\n                        Cancelled Credit Note\n                    {% elif doc.status == \"Cancelled\" %}\n                        Cancelled Invoice\n                    {% elif doc.status == \"Draft\" and doc.is_return %}\n                        Draft Credit Note\n                    {% elif doc.status == \"Draft\" %}\n                        Draft Invoice\n                    {% elif doc.is_return %}\n                        Credit Note\n                    {% elif doc.irn %}\n                        e-Invoice\n                    {% else %}\n                        Tax Invoice\n                    {% endif %}\n                </b>\n            </h2>\n            <b><span style=\"font-size:0.35rem\">{{ invoice_copy_text }}</span></b><br><br>\n            <div class=\"invoice-meta\">\n              <table class=\"table-condensed no-border\" style=\"width:100%; font-size:0.55rem; text-align:left;\">\n                <tr>\n                  <td><b>Invoice Date:</b></td>\n                  <td>{{ frappe.utils.formatdate(doc.posting_date) }}</td>\n                </tr>\n                <tr>\n                  <td><b>Invoice No:</b></td>\n                  <td><b>{{ doc.name }}</b></td>\n                </tr>\n              </table>\n            </div>\n        </div>\n    </div>\n</div>\n\n{% if doc.irn %}\n<div class=\"einv-det\">\n    <!--<div class=\"col-xs-2 column-break text-left\"></div>-->\n    <div class=\"col-xs-4 column-break text-left\">\n        {% if e_invoice_log and e_invoice_log.signed_qr_code %}\n        <img class=\"qrcode\" src=\"data:image/png;base64,{{ get_qr_code(e_invoice_log.signed_qr_code, scale=2) }}\">\n        {% endif %}\n    </div>\n    <div class=\"col-xs-8 column-break text-right\">\n        <div class=\"row data-field\">\n            <div class=\"col-xs-4\"><label>IRN</label></div>\n            <div class=\"col-xs-8 value\"><u>{{ doc.irn }}</u></div>\n        </div>\n        {% if invoice_data and invoice_data.AckNo %}\n        <div class=\"row data-field\">\n            <div class=\"col-xs-4\"><label>Ack. No.</label></div>\n            <div class=\"col-xs-8 value\">{{ invoice_data.AckNo }}</div>\n        </div>\n        {% endif %}\n        {% if invoice_data and invoice_data.AckDt %}\n        <div class=\"row data-field\">\n            <div class=\"col-xs-4\"><label>Ack. Date</label></div>\n            <div class=\"col-xs-8 value\">{{ frappe.utils.format_datetime(invoice_data.AckDt, \"dd/MM/yyyy hh:mm:ss\") }}</div>\n        </div>\n        {% endif %}\n        {% if doc.ewaybill %}\n        <div class=\"row data-field\">\n            <div class=\"col-xs-4\"><label>e-Waybill No.</label></div>\n            <div class=\"col-xs-8 value\"><u>{{ doc.ewaybill }}</u></div>\n        </div>\n        {% endif %}\n    </div>\n    {% if frappe.db.get_value(\"Company\",doc.company,\"bns_previously_known_as\") %}\n                <div>Previously Known As: {{frappe.db.get_value(\"Company\",doc.company,\"bns_previously_known_as\")}}</div>\n            {% endif %}\n    <!--<div class=\"col-xs-1 column-break text-right\">-->\n    </div>\n{% endif %}\n\n<table class=\"table table-bordered party-details-table\">\n    <tbody>\n        <tr>\n            <td colspan=3 rowspan=4 style=\"width:45%;\">\n                {% set contact_person = frappe.db.get_value(\n            \"Contact\", doc.contact_person, (\"mobile_no\"), as_dict=True\n        ) %}\n                <h6><b><u>Buyer Details</u></b></h6>\n                <p><b>{{ doc.customer_name }}</b></p>\n                {% set customer_address = frappe.db.get_value(\"Address\", doc.customer_address, [\"address_line1\", \"address_line2\", \"city\", \"state\", \"pincode\", \"country\",\"gstin\"], as_dict=True) %}\n                {{ format_address(customer_address) }}\n\n                {% if doc.billing_address_gstin %}\n                GST: <u>{{ doc.billing_address_gstin }}</u><br>\n                {% endif %}\n                {% set customer_pan = frappe.db.get_value(\"Customer\", doc.customer_name, \"pan\")%}\n                {% if customer_pan %}\n                PAN: {{ customer_pan }}<br>\n                {% endif %}\n                {% if contact_person.mobile_no %}\n                Phone No: {{ contact_person.mobile_no }}\n                {% endif %}\n                {% if doc.shipping_address %}\n                <br>\n                <h6><b><u>Shipping Details</u></b></h6>\n                {% set shipping_address = frappe.db.get_value(\"Address\", doc.shipping_address_name, [\"address_line1\", \"address_line2\", \"city\", \"state\", \"pincode\", \"country\",\"gstin\"], as_dict=True) %}\n                {{ format_address(shipping_address) }}\n                {% if shipping_address.gstin %}\n                GST: <u>{{ shipping_address.gstin }}</u><br>\n                {% endif %}\n                {% endif %}\n                {% if doc.dispatch_address %}\n                <h6><b><u>Dispatch Details</u></b></h6>\n                <p><b>{{ frappe.db.get_value(\"Address\", doc.dispatch_address_name, \"address_title\") }}</b></p>\n                <!--<p>{{doc.dispatch_address}}</p>-->\n                {% set dispatch_address = frappe.db.get_value(\"Address\", doc.dispatch_address_name, [\"address_line1\", \"address_line2\", \"city\", \"state\", \"pincode\", \"country\"], as_dict=True) %}\n                {{ format_address(dispatch_address) }}\n                {% endif %}\n            </td>\n            <td colspan=\"{{ 2 if (not doc.irn and doc.ewaybill) else 1 }}\">\n                <h6>Transporter:</h6>\n                {% if doc.transporter_name %}\n                {{ doc.transporter_name }} <br>\n                {{ doc.gst_transporter_id }}\n                {% else %}<br>{% endif %}\n            </td>\n            <td colspan=1>\n                <h6>Vehicle No:</h6>\n                {% if doc.vehicle_no %}\n                {{ doc.vehicle_no }}\n                {% else %}<br>{% endif %}\n            </td>\n            <td colspan=1>\n                <h6>Builty No:</h6>\n                {% if doc.custom_builty_no %}\n                {{ doc.custom_builty_no }}\n                {% else %}<br>{% endif %}\n            </td>\n        </tr>\n        <tr>\n            <td colspan=1>\n                <h6>Place Of Supply</h6>\n                {{ doc.place_of_supply }}\n            </td>\n            {% if not doc.irn and doc.ewaybill %}\n            <td colspan=1>\n                <h6>e-Waybill No.</h6>\n                <u>{{ doc.ewaybill }}</u>\n            </td>            \n            {% endif %}\n            <td colspan=1>\n                <h6>Buyer's PO No:</h6>\n                {% if doc.po_no %}\n                {{ doc.po_no }}\n                {% else %}<br>{% endif %}\n            </td>\n            <td colspan=1>\n                <h6>PO Date:</h6>\n                {% if doc.po_date %}\n                {{ doc.po_date }}\n                {% else %}<br>{% endif %}\n            </td>\n        </tr>\n        {% if doc.incoterm or doc.named_place  %}\n        <tr>\n            <td colspan=\"{{ 2 if (not doc.irn and doc.ewaybill) else 1 }}\">\n                <h6>Incoterm:</h6>\n                {% if doc.incoterm %}\n                {{ doc.incoterm }}\n                {% else %}<br>{% endif %}\n            </td>\n            <td colspan=2>\n                <h6>Named Place:</h6>\n                {% if doc.named_place %}\n                {{ doc.named_place }}\n                {% else %}<br>{% endif %}\n            </td>\n        </tr>\n        {% endif %}\n        <tr>\n            <td colspan=1>\n                \n                <h6>Destination:</h6>\n                {% if doc.custom_destination %}\n                {{doc.custom_destination}}\n                {% else %}<br>{% endif %}\n            </td>\n            <td rowspan=2 colspan=\"{{ 3 if (not doc.irn and doc.ewaybill) else 2 }}\">\n                <h6>Terms of Delivery:</h6>\n                {% if doc.custom_terms_of_delivery %}\n                {{ doc.custom_terms_of_delivery }}\n                {% elif doc.custom_terms_of_delivery_new %}\n                {{ doc.custom_terms_of_delivery_new }}\n                {% else %}<br><br>{% endif %}\n            </td>\n        </tr>\n        <tr>\n            <td colspan=1 rowspan=1>\n                <h6>Doc No:</h6>\n                {% if doc.custom_doc_no %}\n                {{doc.custom_doc_no}}\n                {% else %}<br>{% endif %}\n            </td>\n        </tr>\n    </tbody>\n</table>\n\n\n<table class=\"table table-bordered item-det\">\n<thead>\n    <tr>\n        <th colspan=\"2\">#</th>\n        <th colspan=\"24\">Item</th>\n        <th colspan=\"7\">HSN/SAC</th>\n        <th colspan=\"7\">Qty</th>\n        {% if bns_settings.rate_excl_tax %}\n        <th colspan=\"9\">Rate(Exc Tax)</th>\n        {% endif %}\n        {% if doc.is_print_gst_rate_per_row %}\n        <th colspan=\"4\">GST</th>\n        {% endif %}\n        {% if bns_settings.rate_incl_tax %}\n        <th colspan=\"9\">Rate(Inc Tax)</th>\n        {% endif %}\n        {% if bns_settings.discount_type == \"Triple Compounded\" %}\n        <th colspan=\"4\">D1</th>\n        <th colspan=\"4\">D2</th>\n        <th colspan=\"4\">D3</th>\n        {% else %}\n        <th colspan=\"4\">Disc</th>\n        {% endif %}\n        {% if bns_settings.is_item_amount_tax_incl %}\n        <th colspan=\"11\">Amount(Incl)</th>\n        {% else %}\n        <th colspan=\"11\">Amount(Excl)</th>\n        {% endif %}\n    </tr>\n</thead>\n\n    <tbody>\n        {% for item in doc.items %}\n        <tr class=\"no-break {{ 'odd' if loop.index is odd else 'even' }}\">\n            <td colspan=\"2\">{{ loop.index }}</td>\n            <td colspan=\"24\" class=\"item-det-item-name\">\n                <b>{% if bns_settings.show_item_code or doc.bns_show_item_code %}{{ item.item_code }}:{% endif %}{{ item.item_name }}</b><br>\n                {% if item.barcode and (doc.bns_show_item_barcode or bns_settings.bns_show_item_barcode) %}\n                <p style=\"font-size:0.75em;\">\n                    EAN: {{ item.barcode }}\n                </p>\n                {% endif %}\n            </td>\n            <td colspan=\"7\">{{ item.gst_hsn_code }}</td>\n            <td colspan=\"7\">\n                <b>\n                    <span>{{ item.qty }} {{ item.uom }}</span>\n                    {% if bns_settings.secondary_rate_display %}\n                        {% if bns_settings.secondary_rate_field == \"print_uom\" %}\n                            {% set print_uom = frappe.db.get_value(\"Item\", item.item_code, \"custom_print_uom\") %}\n                            {% if print_uom and item.uom != print_uom %}\n                                {% set print_uom_conversion = frappe.db.get_value(\n                                    \"UOM Conversion Detail\",\n                                    {\"parent\": item.item_code, \"uom\": print_uom},\n                                    \"conversion_factor\"\n                                ) %}\n                                <br>\n                                <small style=\"font-size:0.7em;\">{{ (item.conversion_factor * item.qty / print_uom_conversion ) | int }} {{ print_uom }} </small>\n                                \n                            {% endif %}\n                        {% elif bns_settings.secondary_rate_field == \"weight_uom\" and item.total_weight != 0 %}\n                            {% if item.weight_uom == \"Kg\" and item.weight_uom != item.uom %}\n                                <br>\n                                <small style=\"font-size:0.6em;\">{{ item.total_weight }} Kg</small>\n                            {% elif item.weight_uom == \"Gram\" and item.weight_uom != \"Kg\" and item.weight_uom != \"Gram\" %}\n                                <br>\n                                <small style=\"font-size:0.6rem;\">{{ item.total_weight / 1000 }} Kg</small>\n                            {% endif %}\n                        {% endif %}\n                    {% endif %}\n                </b>\n            </td>\n            {% if doc.taxes[0].included_in_print_rate == 1 %}\n            \n                {% set gst_rate = frappe.db.get_value(\"Item Tax Template\",{\"name\": item.item_tax_template},[\"gst_rate\"]) %}\n                {% set inclusive_rate = item.base_price_list_rate %}\n                {% set exclusive_rate = inclusive_rate*100/(100+gst_rate) %}\n            \n            {% else %}\n            \n                {% set gst_rate = frappe.db.get_value(\"Item Tax Template\",{\"name\": item.item_tax_template},[\"gst_rate\"]) %}\n                {% set exclusive_rate = item.base_price_list_rate %}\n                {% set inclusive_rate = exclusive_rate*(100+gst_rate)/100 %}\n            \n            {% endif %}\n            \n            {% if bns_settings.rate_excl_tax %}\n            <td colspan=\"9\">\n                <b>\n                    <span>\n                    {{ frappe.utils.fmt_money(\"{:.2f}\".format(exclusive_rate), currency=base_currency) }}/<small style=\"font-size:0.45rem;\">{{ item.uom }}</small>\n                    </span>\n                    \n                    {% if bns_settings.secondary_rate_display %}\n                        {% if bns_settings.secondary_rate_field == \"print_uom\" %}\n                            {% set print_uom = frappe.db.get_value(\"Item\", item.item_code, \"custom_print_uom\") %}\n                            {% if print_uom and item.uom != print_uom %}\n                                {% set print_uom_conversion = frappe.db.get_value(\n                                    \"UOM Conversion Detail\",\n                                    {\"parent\": item.item_code, \"uom\": print_uom},\n                                    \"conversion_factor\"\n                                ) %}\n                                <br>\n                                <span style=\"font-size:0.9em;\">\n                                {{ frappe.utils.fmt_money(\"{:.2f}\".format(exclusive_rate * print_uom_conversion / item.conversion_factor), currency=base_currency) }}/<small style=\"font-size:0.35rem;\">{{ print_uom }}</small>\n                                </span>\n                            {% endif %}\n                        {% elif bns_settings.secondary_rate_field == \"weight_uom\" and item.total_weight != 0 %}\n                            {% if item.weight_uom == \"Kg\" and item.weight_uom != item.uom %}\n                                <p style=\"font-size:0.8em;\">\n                                    {% set calculated_value = exclusive_rate * item.qty / item.total_weight %}\n                                    {{ frappe.utils.fmt_money(calculated_value, currency=base_currency) }}/Kg\n                                </p>\n                            {% elif item.weight_uom == \"Gram\" and item.weight_uom != \"Kg\" and item.weight_uom != \"Gram\" %}\n                                <p style=\"font-size:0.8em;\">\n                                    {% set calculated_value = exclusive_rate * item.qty * 1000 / item.total_weight %}\n                                    {{ frappe.utils.fmt_money(calculated_value, currency=base_currency) }}/Kg\n                                </p>\n                            {% endif %}\n                        {% endif %}\n                    {% endif %}\n                </b>\n            </td>\n            {% endif %}\n            \n            {% if doc.is_print_gst_rate_per_row %}\n                <td colspan=\"4\">{{ gst_rate | round(0) | int }}%</td>\n            {% endif %}\n            \n            {% if bns_settings.rate_incl_tax %}\n            <td colspan=\"9\">\n                <b>\n                    <span>\n                    {{ frappe.utils.fmt_money(\"{:.2f}\".format(inclusive_rate), currency=base_currency) }}/<small style=\"font-size:0.45rem;\">{{ item.uom }}</small>\n                    </span>\n                    \n                    {% if bns_settings.secondary_rate_display %}\n                        {% if bns_settings.secondary_rate_field == \"print_uom\" %}\n                            {% set print_uom = frappe.db.get_value(\"Item\", item.item_code, \"custom_print_uom\") %}\n                            {% if print_uom and item.uom != print_uom %}\n                                {% set print_uom_conversion = frappe.db.get_value(\n                                    \"UOM Conversion Detail\",\n                                    {\"parent\": item.item_code, \"uom\": print_uom},\n                                    \"conversion_factor\"\n                                ) %}\n                                <br>\n                                <span style=\"font-size:0.9em;\">\n                                {{ frappe.utils.fmt_money(\"{:.2f}\".format(inclusive_rate * print_uom_conversion / item.conversion_factor), currency=base_currency) }}/<small style=\"font-size:0.35rem;\">{{ print_uom }}</small>\n                                </span>\n                            {% endif %}\n                        {% elif bns_settings.secondary_rate_field == \"weight_uom\" and item.total_weight != 0 %}\n                            {% if item.weight_uom == \"Kg\" and item.weight_uom != item.uom %}\n                                <p style=\"font-size:0.8em;\">\n                                    {% set calculated_value = inclusive_rate * item.qty / item.total_weight %}\n                                    {{ frappe.utils.fmt_money(calculated_value, currency=base_currency) }}/Kg\n                                </p>\n                            {% elif item.weight_uom == \"Gram\" and item.weight_uom != \"Kg\" and item.weight_uom != \"Gram\" %}\n                                <p style=\"font-size:0.8em;\">\n                                    {% set calculated_value = inclusive_rate * item.qty * 1000 / item.total_weight %}\n                                    {{ frappe.utils.fmt_money(calculated_value, currency=base_currency) }}/Kg\n                                </p>\n                            {% endif %}\n                        {% endif %}\n                    {% endif %}\n                </b>\n            </td>\n            {% endif %}\n            \n            {% if bns_settings.discount_type != \"Single\" %}\n            <td colspan=\"4\" style=\"font-size:0.8em;\">{{ '-' if item.custom_d1_ == 0.0 else item.custom_d1_ ~ '%' }}</td>\n            <td colspan=\"4\" style=\"font-size:0.8em;\">{{ '-' if item.custom_d2_ == 0.0 else item.custom_d2_ ~ '%' }}</td>\n            <td colspan=\"4\" style=\"font-size:0.8em;\">{{ '-' if item.custom_d3_ == 0.0 else item.custom_d3_ ~ '%' }}</td>\n            {% else %}\n            <td colspan=\"4\">{{ item.discount_percentage }}% </td>\n            {% endif %}\n            {% if bns_settings.is_item_amount_tax_incl %}\n            <td colspan=\"11\"><b>{{ frappe.utils.fmt_money(\"{:.2f}\".format(item.base_net_amount*(1+(gst_rate/100))), currency=base_currency) }}</b></td>\n            {% else %}\n            <td colspan=\"11\"><b>{{ frappe.utils.fmt_money(\"{:.2f}\".format(item.base_net_amount), currency=base_currency) }}</b></td>\n            {% endif %}\n        </tr>\n        {% endfor %}\n    </tbody>\n</table>\n\n<div class=\"final-tax-total-table\">\n    <table class=\"table table-bordered\">\n        <tbody>\n            <tr>\n                <td rowspan=1 colspan=5 style=\"vertical-align:top !important; width:45%;\" class=\"text-center\"><b>Bank Details</b></td>\n                <td class=\"text-right\" colspan=2><b>Total Taxable Value</b></td>\n                <td class=\"text-right text-nowrap\" colspan=2>{{ frappe.utils.fmt_money(\"{:.2f}\".format(doc.base_net_total), currency=base_currency) }}</td>\n            </tr>\n            {% set ns = namespace(freight_row=false) %}\n            \n            {% for tax_row in doc.taxes %}\n                {% if \"Freight and Forwarding Charges\" in tax_row.account_head %}\n                    {% set ns.freight_row = tax_row %}\n                {% endif %}\n            {% endfor %}\n            {% set freight_row = ns.freight_row %}\n                \n                <tr>\n                    <td class=\"text-center\" rowspan={% if doc.discount_amount and freight_row %}5{%elif doc.discount_amount or freight_row %}4{%else%}3{%endif%} colspan=5 style=\"vertical-align:top !important;\">\n                        {% set bank_account = frappe.db.get_value(\"Bank Account\", {\"company\": doc.company, \"is_default\": 1}, [\"account_name\",\"bank\", \"bank_account_no\", \"branch_code\",\"iban\"], as_dict=True) %}\n                        {% if bank_account.account_name %}\n                        Account Name: <b><i>{{ bank_account.account_name }}</i></b><br>\n                        {% endif %}\n                        {% if bank_account.bank %}\n                        Bank Name: <b><i>{{ bank_account.bank }}</i></b><br>\n                        {% endif %}\n                        {% if bank_account.bank_account_no %}\n                        Account Number: <b><i>{{ bank_account.bank_account_no }}</i></b><br>\n                        {% endif %}\n                        {% if bank_account.branch_code %}\n                        Branch Code (IFSC): <b><i>{{ bank_account.branch_code }}</i></b><br>\n                        {% endif %}\n                        {% if bank_account.iban %}\n                        IBAN: <b><i>{{ bank_account.iban }}</i></b><br>\n                        {% endif %}\n                    </td>\n                    <td class=\"text-right\" colspan=2><b>Total Taxes and Charges</b></td>\n                    <td class=\"text-right text-nowrap\" colspan=2>{{ frappe.utils.fmt_money(\"{:.2f}\".format(doc.base_total_taxes_and_charges), currency=base_currency) }}</td>\n                </tr>\n            {% if freight_row %}\n                <tr>\n                    <td class=\"text-right\" style=\"font-size:0.8em;\">Freight and Forwarding Charges</td>\n                    <td class=\"text-right text-nowrap\">{{ frappe.utils.fmt_money(\"{:.2f}\".format(freight_row.tax_amount), currency=doc.currency) }}</td>\n                </tr>\n                {% endif %}\n            {% if doc.discount_amount %}\n            <tr>\n                <td class=\"text-right\" colspan=2>Additional Discount</td>\n                <td class=\"text-right text-nowrap\" colspan=2><b>{{ frappe.utils.fmt_money(doc.base_discount_amount, currency=base_currency) }}</b></td>\n            </tr>\n            {% endif %}\n            <tr>\n                <td class=\"text-right\" colspan=2><b>Grand Total</b></td>\n                <td class=\"text-right text-nowrap\" colspan=2><b>{{ frappe.utils.fmt_money(doc.base_rounded_total, currency=base_currency) }}</b></td>\n            </tr>\n            <tr>\n                <td colspan=4>\n                    <b>Amount (in words): </b><span style=\"font-size:0.85em\">{{ doc.base_in_words }}</span>\n                </td>\n            </tr>\n        </tbody>\n    </table>\n    \n    {{ doc.gst_breakup_table }}\n    {% if doc.is_print_gst_table %}\n    \n    {% set gst_summary = {} %}\n    {% set gst_flags = {\"uses_igst\": false, \"uses_cgst_sgst\": false} %}\n        \n        {% for item in doc.items %}\n            {% set gst_rate = (frappe.db.get_value(\"Item Tax Template\", {\"name\": item.item_tax_template}, \"gst_rate\") or 0) | float %}\n            {% set key = gst_rate|string %}\n        \n            {% if item.igst_amount %}\n                {% set _ = gst_flags.update({\"uses_igst\": true}) %}\n                {% if gst_summary[key] is not defined %}\n                    {% set _ = gst_summary.update({ key: {\n                        \"gst_rate\": gst_rate,\n                        \"taxable_value\": 0,\n                        \"igst_amount\": 0\n                    } }) %}\n                {% endif %}\n                {% set _ = gst_summary[key].update({\n                    \"taxable_value\": gst_summary[key].taxable_value + item.net_amount,\n                    \"igst_amount\": gst_summary[key].igst_amount + item.igst_amount\n                }) %}\n            {% elif item.cgst_amount and item.sgst_amount %}\n                {% set _ = gst_flags.update({\"uses_cgst_sgst\": true}) %}\n                {% if gst_summary[key] is not defined %}\n                    {% set _ = gst_summary.update({ key: {\n                        \"gst_rate\": gst_rate,\n                        \"taxable_value\": 0,\n                        \"cgst_amount\": 0,\n                        \"sgst_amount\": 0\n                    } }) %}\n                {% endif %}\n                {% set _ = gst_summary[key].update({\n                    \"taxable_value\": gst_summary[key].taxable_value + item.net_amount,\n                    \"cgst_amount\": gst_summary[key].cgst_amount + item.cgst_amount,\n                    \"sgst_amount\": gst_summary[key].sgst_amount + item.sgst_amount\n                }) %}\n            {% endif %}\n        {% endfor %}\n        \n        <h4>GST Summary</h4>\n        <table class=\"table table-bordered table-hover\" style=\"text-align: center;\">\n            <thead>\n                <tr>\n                    <th rowspan=\"2\" style=\"text-align: center; vertical-align: middle;\">GST RATE</th>\n                    <th rowspan=\"2\" style=\"text-align: center; vertical-align: middle;\">Taxable Value</th>\n                    {% if gst_flags.uses_cgst_sgst %}\n                        <th colspan=\"2\" style=\"text-align: center; vertical-align: middle;\">CGST</th>\n                        <th colspan=\"2\" style=\"text-align: center; vertical-align: middle;\">SGST/UTGST</th>\n                    {% elif gst_flags.uses_igst %}\n                        <th colspan=\"2\" style=\"text-align: center; vertical-align: middle;\">IGST</th>\n                    {% endif %}\n                </tr>\n                <tr>\n                    {% if gst_flags.uses_cgst_sgst %}\n                        <th style=\"text-align: center; vertical-align: middle;\">Rate</th>\n                        <th style=\"text-align: center; vertical-align: middle;\">Amount</th>\n                        <th style=\"text-align: center; vertical-align: middle;\">Rate</th>\n                        <th style=\"text-align: center; vertical-align: middle;\">Amount</th>\n                    {% elif gst_flags.uses_igst %}\n                        <th style=\"text-align: center; vertical-align: middle;\">Rate</th>\n                        <th style=\"text-align: center; vertical-align: middle;\">Amount</th>\n                    {% endif %}\n                </tr>\n            </thead>\n            <tbody>\n                {% for row in gst_summary.values() %}\n                    <tr>\n                        <td>{{ row.gst_rate }}%</td>\n                        <td>{{ frappe.utils.fmt_money(\"{:.2f}\".format(row.taxable_value), currency=doc.currency) }}</td>\n        \n                        {% if gst_flags.uses_cgst_sgst %}\n                            <td>{{ (row.gst_rate / 2) | round(1) }}%</td>\n                            <td>{{ frappe.utils.fmt_money(\"{:.2f}\".format(row.cgst_amount), currency=doc.currency) }}</td>\n                            <td>{{ (row.gst_rate / 2) | round(1) }}%</td>\n                            <td>{{ frappe.utils.fmt_money(\"{:.2f}\".format(row.sgst_amount), currency=doc.currency) }}</td>\n                        {% elif gst_flags.uses_igst %}\n                            <td>{{ row.gst_rate }}%</td>\n                            <td>{{ frappe.utils.fmt_money(\"{:.2f}\".format(row.igst_amount), currency=doc.currency) }}</td>\n                        {% endif %}\n                    </tr>\n                {% endfor %}\n            </tbody>\n        </table>\n    \n    \n    {% endif %}\n    \n    \n    <table class=\"table table-bordered\" style=\" table-layout: fixed; border-collapse: collapse; width:100%; text-align:center; font-size:12px;\">\n        <tr rowspan=1>\n            <td rowspan=1 colspan=4>\n                <b>{% if doc.is_print_payment_terms==1%} Payment Terms {% endif %}</b>\n            </td>\n            <td colspan=4>\n                <b>Pre Authenticated By: {{doc.company}}</b>\n            </td>\n        </tr>\n        <tr>\n            <td colspan=4 rowspan=3>\n            {% if doc.payment_schedule and doc.is_print_payment_terms==1 %}\n            <table class=\"payment_terms_table\" style=\"width: 100%; border-collapse: collapse;\">\n                <thead>\n                    <tr>\n                        <th style=\"border: 1px solid black; padding: 8px;\"><b>Due Date</b></th>\n                        <th style=\"border: 1px solid black; padding: 8px;\"><b>Invoice Portion</b></th>\n                        <th style=\"border: 1px solid black; padding: 8px;\"><b>Payment Amount</b></th>\n    \n                    </tr>\n                </thead>\n                <tbody>\n                    {% for row in doc.payment_schedule %}\n                    <tr>\n                        <td style=\"border: 1px solid black; padding: 8px;\">{{ row.due_date }}</td>\n                        <td style=\"border: 1px solid black; padding: 8px;\">{{ row.invoice_portion }}%</td>\n                        <td style=\"border: 1px solid black; padding: 8px;\">{{ frappe.utils.fmt_money(row.payment_amount, currency=\"INR\") }}</td>\n                    </tr>\n                    {% endfor %}\n                </tbody>\n            </table>\n            {% endif %}\n            </td>\n            <td colspan=4>\n                Issuing Signatory\n            </td>\n        </tr>\n        <tr rowspan=1>\n            <td colspan=1 style=\"text-align:left\">\n                Name:\n            </td>\n            <td colspan=3></td>\n        </tr>\n        <tr rowspan=1>\n            <td colspan=1 style=\"text-align:left;\">\n                Designation:\n            </td>\n            <td colspan=3></td>\n        </tr>\n    </table>\n\n</div>\n\n<div class=\"page-break\"></div>\n\n\n\n\n\n<div id=\"footer-html\">\n    <div class=\"text-center small page-footer-1\">\n        {{ _(\"Page {0} of {1}\").format('<span class=\"page\"></span>', '<span class=\"topage\"></span>') }}<br>This is a computer generated document and does not require a signature.\n    </div>\n</div>\n",
 "idx": 0,
 "line_breaks": 0,
 "margin_bottom": 0.0,
 "margin_left": 0.0,
 "margin_right": 0.0,
 "margin_top": 0.0,
 "modified": "2025-09-22 15:56:13.115758",
 "modified_by": "Administrator",
 "module": "Business Needed Solutions",
 "name": "BNS SI Dynamic V2",
 "owner": "sagarratangarg@rbcolour.com",
 "page_number": "Bottom Center",
 "pdf_generator": "wkhtmltopdf",
 "print_format_builder": 0,
 "print_format_builder_beta": 0,
 "print_format_for": "DocType",
 "print_format_type": "Jinja",
 "raw_printing": 0,
 "show_section_headings": 0,
 "standard": "Yes"
}